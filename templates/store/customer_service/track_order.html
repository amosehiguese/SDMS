{% extends 'base.html' %}
{% block title %}Track Your Order - {{ site_config.site_name|default:'Store' }}{% endblock %}
{% block content %}
<!-- Hero Section -->
<div class="bg-gradient-to-br from-indigo-50 to-blue-50 py-16">
    <div class="container mx-auto px-4">
        <div class="text-center max-w-3xl mx-auto">
            <div class="mb-6">
                <i class="fas fa-search text-6xl text-indigo-700"></i>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Track Your Order</h1>
            <p class="text-xl text-gray-600">Stay updated on your order status and delivery progress</p>
        </div>
    </div>
</div>

<!-- Main Content -->
<div class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="max-w-2xl mx-auto">
            <!-- Order Tracking Form -->
            <div class="bg-white border border-gray-200 rounded-lg p-8 mb-12 shadow-lg">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Enter Your Order Details</h2>
                    <p class="text-gray-600">
                        Enter your order number below to get real-time tracking information for your shipment.
                    </p>
                </div>
                
                <form class="space-y-6">
                    <div>
                        <label for="order_number" class="block text-sm font-medium text-gray-700 mb-2">
                            Order Number <span class="text-red-500">*</span>
                        </label>
                        <input type="text" 
                               id="order_number" 
                               name="order_number" 
                               class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors" 
                               placeholder="e.g., #ORD-123456789"
                               required>
                        <p class="text-sm text-gray-500 mt-1">
                            <i class="fas fa-info-circle mr-1"></i>
                            You can find this in your order confirmation email
                        </p>
                    </div>
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                            Email Address <span class="text-red-500">*</span>
                        </label>
                        <input type="email" 
                               id="email" 
                               name="email" 
                               class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors" 
                               placeholder="your@email.com"
                               required>
                        <p class="text-sm text-gray-500 mt-1">
                            <i class="fas fa-info-circle mr-1"></i>
                            The email address used when placing the order
                        </p>
                    </div>
                    
                    <button type="button" 
                            onclick="trackOrder()" 
                            class="w-full bg-indigo-700 text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-800 transition-colors flex items-center justify-center">
                        <i class="fas fa-search mr-2"></i>
                        Track My Order
                    </button>
                </form>
            </div>

            <!-- Order Status Display (Initially Hidden) -->
            <div id="order-status" class="hidden bg-white border border-gray-200 rounded-lg p-8 shadow-lg">
                <!-- This will be populated by JavaScript -->
            </div>

            <!-- Alternative Tracking Methods -->
            <div class="space-y-8">
                <!-- Email Tracking -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-3">
                        <i class="fas fa-envelope mr-2"></i>
                        Email Tracking Updates
                    </h3>
                    <p class="text-blue-700 mb-4">
                        We automatically send tracking updates to your email address at every stage of the delivery process:
                    </p>
                    <ul class="text-blue-700 space-y-1 text-sm">
                        <li class="flex items-center"><i class="fas fa-check-circle mr-2"></i>Order confirmed and payment received</li>
                        <li class="flex items-center"><i class="fas fa-check-circle mr-2"></i>Order processed and ready for shipping</li>
                        <li class="flex items-center"><i class="fas fa-check-circle mr-2"></i>Package shipped with tracking number</li>
                        <li class="flex items-center"><i class="fas fa-check-circle mr-2"></i>Package out for delivery</li>
                        <li class="flex items-center"><i class="fas fa-check-circle mr-2"></i>Package delivered successfully</li>
                    </ul>
                </div>

                <!-- Order Status Meanings -->
                <div class="bg-gray-50 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-info-circle mr-2"></i>
                        Understanding Order Status
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-3">
                            <div class="flex items-start">
                                <div class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">PENDING</div>
                                <p class="text-sm text-gray-600">Order received, awaiting payment confirmation</p>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">PROCESSING</div>
                                <p class="text-sm text-gray-600">Payment confirmed, order being prepared</p>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">SHIPPED</div>
                                <p class="text-sm text-gray-600">Package dispatched and on its way to you</p>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="flex items-start">
                                <div class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">IN TRANSIT</div>
                                <p class="text-sm text-gray-600">Package is traveling to your delivery address</p>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">DELIVERED</div>
                                <p class="text-sm text-gray-600">Package successfully delivered to your address</p>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold mr-3 mt-0.5">RETURNED</div>
                                <p class="text-sm text-gray-600">Package couldn't be delivered and was returned</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Need Help -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-6 text-center">
                    <h3 class="text-lg font-semibold text-amber-800 mb-3">
                        <i class="fas fa-question-circle mr-2"></i>
                        Can't Find Your Order?
                    </h3>
                    <p class="text-amber-700 mb-4">
                        If you're having trouble tracking your order or have questions about delivery, 
                        our customer service team is here to help.
                    </p>
                    <div class="flex flex-col md:flex-row gap-3 justify-center">
                        <a href="mailto:{{ site_config.contact_email|default:'support@example.com' }}" 
                           class="bg-amber-700 text-white px-6 py-2 rounded-lg font-semibold hover:bg-amber-800 transition-colors inline-flex items-center justify-center">
                            <i class="fas fa-envelope mr-2"></i>
                            Contact Support
                        </a>
                        <a href="{% url 'store:help_center' %}" 
                           class="bg-white border border-amber-300 text-amber-700 px-6 py-2 rounded-lg font-semibold hover:bg-amber-50 transition-colors inline-flex items-center justify-center">
                            <i class="fas fa-life-ring mr-2"></i>
                            Help Center
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 

{% block extra_js %}
<script>
    function showNotification(message, type = 'info') {
        const colors = {
            success: 'bg-green-500',
            error: 'bg-red-500',
            info: 'bg-blue-500',
            warning: 'bg-amber-500'
        };
        
        const icons = {
            success: 'fa-check-circle',
            error: 'fa-exclamation-circle',
            info: 'fa-info-circle',
            warning: 'fa-exclamation-triangle'
        };
        
        const notification = $(`
            <div class="fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform max-w-md">
                <div class="flex items-center">
                    <i class="fas ${icons[type]} mr-2"></i>
                    <span>${message}</span>
                </div>
            </div>
        `);
        
        $('body').append(notification);
        
        setTimeout(() => {
            notification.removeClass('translate-x-full');
        }, 100);
        
        setTimeout(() => {
            notification.addClass('translate-x-full');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }

    function trackOrder() {
        const orderNumber = document.getElementById('order_number').value.trim();
        const email = document.getElementById('email').value.trim();
        
        if (!orderNumber || !email) {
            showNotification('Please enter both order number and email address.', 'error')
            return;
        }
        
        // Show loading state
        const button = event.target;
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Tracking...';
        button.disabled = true;
        
        // Simulate API call (replace with actual tracking API)
        setTimeout(() => {
            // Reset button
            button.innerHTML = originalText;
            button.disabled = false;
            
            // Show mock order status (replace with actual data)
            showOrderStatus({
                orderNumber: orderNumber,
                status: 'SHIPPED',
                estimatedDelivery: '2024-01-15',
                trackingNumber: 'TRK123456789',
                events: [
                    { date: '2024-01-10', time: '09:00', status: 'Order Confirmed', description: 'Your order has been confirmed and payment received.' },
                    { date: '2024-01-11', time: '14:30', status: 'Processing', description: 'Your order is being prepared for shipment.' },
                    { date: '2024-01-12', time: '16:45', status: 'Shipped', description: 'Your package has been dispatched from our warehouse.' },
                    { date: '2024-01-13', time: '10:20', status: 'In Transit', description: 'Your package is on its way to the delivery address.' }
                ]
            });
        }, 2000);
    }
    
    function showOrderStatus(data) {
        const statusContainer = document.getElementById('order-status');
        statusContainer.innerHTML = `
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Order Status</h3>
                <p class="text-gray-600">Order ${data.orderNumber}</p>
            </div>
            
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <span class="inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">${data.status}</span>
                        <p class="text-green-700 mt-1">Tracking Number: ${data.trackingNumber}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm text-green-600">Estimated Delivery</p>
                        <p class="font-semibold text-green-800">${data.estimatedDelivery}</p>
                    </div>
                </div>
            </div>
            
            <div>
                <h4 class="font-semibold text-gray-800 mb-4">Tracking History</h4>
                <div class="space-y-4">
                    ${data.events.map(event => `
                        <div class="flex items-start space-x-4 p-4 bg-gray-50 rounded-lg">
                            <div class="bg-indigo-100 text-indigo-700 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fas fa-check text-sm"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="font-semibold text-gray-800">${event.status}</p>
                                        <p class="text-gray-600 text-sm">${event.description}</p>
                                    </div>
                                    <div class="text-right text-sm text-gray-500">
                                        <p>${event.date}</p>
                                        <p>${event.time}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
        statusContainer.classList.remove('hidden');
        statusContainer.scrollIntoView({ behavior: 'smooth' });
    }
</script>
{% endblock %}